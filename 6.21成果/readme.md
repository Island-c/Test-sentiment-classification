### 代码

代码保存在 a.py

代码结构混乱，但至少可以运行了。。。

测试集准确率 0.63 。。比瞎猜稍微强一点。



### 模型

```
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_6 (InputLayer)         (None, 20)                0         
_________________________________________________________________
Embedding (Embedding)        (None, 20, 128)           256128    
_________________________________________________________________
conv1d_4 (Conv1D)            (None, 20, 128)           49280     
_________________________________________________________________
global_max_pooling1d_4 (Glob (None, 128)               0         
_________________________________________________________________
dropout_7 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 500)               64500     
_________________________________________________________________
dropout_8 (Dropout)          (None, 500)               0         
_________________________________________________________________
dense_8 (Dense)              (None, 2)                 1002      
=================================================================
Total params: 370,910
Trainable params: 370,910
Non-trainable params: 0
_________________________________________________________________
```



## 训练集和验证集log

```
Train on 3083 samples, validate on 343 samples
Epoch 1/20
3083/3083 [==============================] - 1s 323us/step - loss: 0.5676 - acc: 0.7058 - val_loss: 0.3974 - val_acc: 0.8338
Epoch 2/20
3083/3083 [==============================] - 1s 202us/step - loss: 0.2989 - acc: 0.8784 - val_loss: 0.2431 - val_acc: 0.8921
Epoch 3/20
3083/3083 [==============================] - 1s 202us/step - loss: 0.1864 - acc: 0.9342 - val_loss: 0.2002 - val_acc: 0.9067
Epoch 4/20
3083/3083 [==============================] - 1s 203us/step - loss: 0.1393 - acc: 0.9491 - val_loss: 0.1936 - val_acc: 0.8980
Epoch 5/20
3083/3083 [==============================] - 1s 204us/step - loss: 0.1011 - acc: 0.9666 - val_loss: 0.1970 - val_acc: 0.9096
Epoch 6/20
3083/3083 [==============================] - 1s 198us/step - loss: 0.0730 - acc: 0.9786 - val_loss: 0.2011 - val_acc: 0.9184
Epoch 7/20
3083/3083 [==============================] - 1s 201us/step - loss: 0.0545 - acc: 0.9854 - val_loss: 0.2012 - val_acc: 0.9242
Epoch 8/20
3083/3083 [==============================] - 1s 201us/step - loss: 0.0389 - acc: 0.9893 - val_loss: 0.2339 - val_acc: 0.9155
Epoch 9/20
3083/3083 [==============================] - 1s 204us/step - loss: 0.0324 - acc: 0.9922 - val_loss: 0.2138 - val_acc: 0.9155
Epoch 10/20
3083/3083 [==============================] - 1s 202us/step - loss: 0.0224 - acc: 0.9948 - val_loss: 0.2237 - val_acc: 0.9184
Epoch 11/20
3083/3083 [==============================] - 1s 205us/step - loss: 0.0183 - acc: 0.9948 - val_loss: 0.2487 - val_acc: 0.9155
Epoch 12/20
3083/3083 [==============================] - 1s 201us/step - loss: 0.0186 - acc: 0.9932 - val_loss: 0.2531 - val_acc: 0.9271
Epoch 13/20
3083/3083 [==============================] - 1s 203us/step - loss: 0.0104 - acc: 0.9977 - val_loss: 0.2792 - val_acc: 0.9213
Epoch 14/20
3083/3083 [==============================] - 1s 203us/step - loss: 0.0100 - acc: 0.9968 - val_loss: 0.3042 - val_acc: 0.9213
Epoch 15/20
3083/3083 [==============================] - 1s 202us/step - loss: 0.0077 - acc: 0.9977 - val_loss: 0.3080 - val_acc: 0.9213
Epoch 16/20
3083/3083 [==============================] - 1s 204us/step - loss: 0.0054 - acc: 0.9987 - val_loss: 0.3217 - val_acc: 0.9271
Epoch 17/20
3083/3083 [==============================] - 1s 206us/step - loss: 0.0052 - acc: 0.9990 - val_loss: 0.3660 - val_acc: 0.9155
Epoch 18/20
3083/3083 [==============================] - 1s 198us/step - loss: 0.0047 - acc: 0.9990 - val_loss: 0.3587 - val_acc: 0.9184
Epoch 19/20
3083/3083 [==============================] - 1s 201us/step - loss: 0.0053 - acc: 0.9987 - val_loss: 0.3577 - val_acc: 0.9242
Epoch 20/20
3083/3083 [==============================] - 1s 207us/step - loss: 0.0063 - acc: 0.9984 - val_loss: 0.3985 - val_acc: 0.9155

```

### 测试集

测试集正确率 ： 0.6312718786464411

具体情况见当前目录下 “测试集.csv”